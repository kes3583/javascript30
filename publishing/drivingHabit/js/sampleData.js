var recentRecord = {
    "recentRecord":   [{
        "date": "2017/12",
        "score": "70"
    }, {
        "date": "2018/1",
        "score": "90"
    }, {
        "date": "2018/2",
        "score": "89"
    }, {
        "date": "2018/3",
        "score": "92"
    }/*, {
        "date": "2018/4",
        "score": "72"
    }*/]
}

var myScore = {
    "reports": [/*{
        "date": "2017/5",
        "myscore":87,
        "monthAvg": 56
    },
    {
        "date": "2017/6",
        "myscore":90,
        "monthAvg": 60
    },
    {
        "date": "2017/7",
        "myscore":95,
        "monthAvg": 47
    },
    {
        "date": "2017/8",
        "myscore":69,
        "monthAvg": 51
    },
    {
        "date": "2017/9",
        "myscore":84,
        "monthAvg": 52
    },
    {
        "date": "2017/10",
        "myscore":75,
        "monthAvg": 58
    },
    {
        "date": "2017/11",
        "myscore":85,
        "monthAvg": 59
    },
    {
        "date": "2017/12",
        "myscore":83,
        "monthAvg": 62
    },
    {
        "date": "2018/1",
        "myscore":86,
        "monthAvg": 60
    },
    {
        "date": "2018/2",
        "myscore":26,
        "monthAvg": 60
    },
    {
        "date": "2018/3",
        "myscore":86,
        "monthAvg": 60
    },*/{
        "date": "2018/4",
        "myscore":86,
        "monthAvg": 60
    }]
}

var monthScore = {
    "reports": [/*{
        "date": "2017/5",
        "myscore":87,
        "overSpeedScore": 80,
        "overSpeedCount": 9,
        "overSpeedDistance" : 200,
        "accelScore" : 65,
        "accelCount": 5,
        "reduceScore": 40,
        "reduceCount" : 10,
        "distance": 520,
        "time": 560 * 60,
        "count": 27
    },
    {
        "date": "2017/6",
        "myscore":90,
        "overSpeedScore": 70,
        "overSpeedCount": 8,
        "overSpeedDistance" : 300,
        "accelScore" : 55,
        "accelCount": 5,
        "reduceScore": 30,
        "reduceCount" : 10,
        "distance": 530,
        "time": 540 * 60,
        "count": 28
    },*/
    {
        "date": "2017/7",
        "myscore":99,
        "overSpeedScore": 60,
        "overSpeedCount": 7,
        "overSpeedDistance" : 400,
        "accelScore" : 45,
        "accelCount": 5,
        "reduceScore": 20,
        "reduceCount" : 10,
        "distance": 540,
        "time": 520 * 60,
        "count": 29
    }/*,
    {
        "date": "2017/8",
        "myscore":69,
        "overSpeedScore": 50,
        "overSpeedCount": 6,
        "overSpeedDistance" : 500,
        "accelScore" : 35,
        "accelCount": 5,
        "reduceScore": 35,
        "reduceCount" : 10,
        "distance": 550,
        "time": 500 * 60,
        "count": 30
    },
    {
        "date": "2017/9",
        "myscore":84,
        "overSpeedScore": 59,
        "overSpeedCount": 5,
        "overSpeedDistance" : 1100,
        "accelScore" : 25,
        "accelCount": 5,
        "reduceScore": 50,
        "reduceCount" : 10,
        "distance": 560,
        "time": 480 * 60,
        "count": 31
    },
    {
        "date": "2017/10",
        "myscore":75,
        "overSpeedScore": 40,
        "overSpeedCount": 4,
        "overSpeedDistance" : 2100,
        "accelScore" : 30,
        "accelCount": 5,
        "reduceScore": 65,
        "reduceCount" : 10,
        "distance": 570,
        "time": 460 * 60,
        "count": 32
    },/*
    {
        "date": "2017/11",
        "myscore":85,
        "monthAvg": 59
    },
    {
        "date": "2017/12",
        "myscore":83,
        "monthAvg": 62
    },
    {
        "date": "2018/1",
        "myscore":86,
        "monthAvg": 60
    },
    {
        "date": "2018/2",
        "myscore":86,
        "monthAvg": 60
    }*/,
    {
        "date": "2018/3",
        "myscore":100,
        "overSpeedScore": 99,
        "overSpeedCount": 3,
        "overSpeedDistance" : 5135,
        "accelScore" : 85,
        "accelCount": 5,
        "reduceScore": 60,
        "reduceCount" : 10,
        "distance": 580,
        "time": 421 * 60,
        "count": 33
    }/*,{
        "date": "2018/4",
        "myscore":0,
        "overSpeedScore": 30,
        "overSpeedCount": 3,
        "overSpeedDistance" : 5135,
        "accelScore" : 80,
        "accelCount": 5,
        "reduceScore": 60,
        "reduceCount" : 10,
        "distance": 580,
        "time": 421 * 60,
        "count": 33
    }*/]
}

var dailyRecord = {
    "daily": [{"date":"2017/1/3","score":72},
            {"date":"2017/1/13","score":55},
            {"date":"2017/1/14","score":30},
            {"date":"2017/1/15","score":33},
            {"date":"2017/1/22","score":80},
            {"date":"2017/1/28","score":4},
            {"date":"2017/1/29","score":24},
            {"date":"2017/4/10","score":45},
            {"date":"2017/4/14","score":77},
            {"date":"2017/4/21","score":82},
            {"date":"2017/5/1","score":22},
            {"date":"2017/6/8","score":28},
            {"date":"2017/6/13","score":40},
            {"date":"2017/6/22","score":43},
            {"date":"2017/6/30","score":83},
            {"date":"2017/7/20","score":47},
            {"date":"2017/8/15","score":53},
            {"date":"2017/9/1","score":61},
            {"date":"2017/9/1","score":63},
            {"date":"2017/9/14","score":6},
            {"date":"2017/10/12","score":75},
            {"date":"2017/10/24","score":63},
            {"date":"2017/11/15","score":65},
            {"date":"2017/11/28","score":7},
            {"date":"2017/11/29","score":59},
            {"date":"2017/12/2","score":50},
            {"date":"2017/12/2","score":1},
            {"date":"2017/12/12","score":95},
            {"date":"2017/12/29","score":85},
            {"date":"2018/1/24","score":85}]
}

//아래 스크립트는 지도를 위한 테스트 소스이므로 실제로는 불필요한 소스
function setSampleMap(){
    var map;
    var markers;
    var marker;
    var mercator;
    var geographic;
    var cLonLat;

    var lon = '14135912.880612050';
    var lon2 = '4571667';
   
    var lat = '4518334.160091842';
    var lat2 = '1352272';
    
    var poi_name='서울특별시 중구 명동 ';

    var BESSEL;
    var _converter;
    //////////////////////////////////////
    BESSEL      = "BESSEL";
    //_converter = new TopConverter({in_coordtype:BESSEL,out_coordtype:BESSEL});
    ////////////////////////////////////
    
    
    
    function setMapWidth(){
            return "auto"
    }
    function setMapHeight(){
        return  $("#map_div").outerHeight()
    }

    function init() {
        poi_name = '서울특별시 중구 명동 ';
        var addr = '서울특별시 중구 명동 ';
        var poi_tel = '';

        //Tmap.ProxyHost = "http://mobile.tipoff.co.kr//cgi-bin/proxy.cgi?url=";
        mercator = new Tmap.Projection("EPSG:3857"); // Google Mercator 좌표계
        geographic = new Tmap.Projection("EPSG:4326");//GPS WGS84 좌표계. 구글 Earth가 사용하고 있는 좌표입니다.
        
      
        
        var mapWidth = setMapWidth();
        var mapHeight = setMapHeight();
         map = new Tmap.Map({div:'map_div', width:mapWidth, height:mapHeight,  attribution : ""});
       

        // 14128992, 4516451 일때
        

        
        /////////////////////////////
        var point = {x:lon2,y:lat2};
        point = {x: 14136309.762768267, y: 4518282.090313867};
        //////////////////////////////
        
        cLonLat = new Tmap.LonLat(point.x, point.y);
        

        
        map.setCenter(cLonLat,16);
        var clickLayer = new Tmap.Layer.Vector("clickLayer");
        markers = new Tmap.Layer.Markers( "MarkerLayer" );
        map.addLayer(clickLayer);
        map.addLayer(markers);

        // marker 찍기
        if(marker != null){
            marker.destroy();
        }

        var size = new Tmap.Size(34,39);
        var offset = new Tmap.Pixel(-(size.w/2), -size.h);

        var iconHtml = new Tmap.IconHtml('<img src="/images/marker_position.png"/>',size,offset);
        marker = new Tmap.Markers(cLonLat, iconHtml);

        marker.events.register("click", marker, function(event){
                content = '<h3>' + '서울특별시 중구 명동 ' + '</h3>';
                popup = new Tmap.Popup.FramedCloud("cloudPopup", cLonLat, new Tmap.Size(100, 100), content, null, true,
                        function(evt){
                            this.hide();
                        }
                );
                map.addPopup(popup);

            });

        markers.addMarker(marker);

        if($.trim(poi_name) == '') $("#location").hide();
        if($.trim(addr) == '') $("#address").hide();
        if($.trim(poi_tel) == '') $("#phone").hide();
    }       


    

    var ua = navigator.userAgent.toLocaleLowerCase();
    function run() {
    
             var tmapInstallUrl="https://poi.tmap.co.kr"+"/tmap2/mobile/downloadTmap.jsp";
             var addrSerach='';
             var centerX='';
             var centerY='';
             var wgs84CenterX='';
             var wgs84CenterY='';
             var goalid ='';
             
            
            var schemeUrl = {
                android : "http://www.tmap.co.kr/tmap2/mobile/route.jsp?name="+addrSerach+"&lon="+wgs84CenterX+"&lat="+wgs84CenterY,
                ios : "tmap://route?goalx="+centerX+"&goaly="+centerY+"&goalid="+goalid+"&goalname="+addrSerach,
                etc: "http://www.tmap.co.kr/tmap2/mobile/route.jsp?name="+addrSerach+"&lon="+wgs84CenterX+"&lat="+wgs84CenterY,
            }
     
            
            if (ua.search("android") > -1) {
      
                if (parseFloat(navigator.userAgent.match(/WebKit\/[^\ ]*/)[0].toLowerCase().substr(7)) > 537.22){
                    location.href = schemeUrl["android"];
                } else {
                    $('<iframe></iframe>', {
                        src: schemeUrl["android"],
                        width: 0,
                        height: 0,
                        id: 'checkframe'
                    }).css('border', '0').appendTo('body');
                }

            }else if(ua.search("iphone") > -1 || ua.search("ipod") > -1 || ua.search("ipad") > -1) {
                window.location = schemeUrl["ios"];
                
            }else{
                window.location = schemeUrl["etc"];
            }
     }//end run
    
   
  var winWidth = 0;
  $(function(){
      
      console.log("infoPanel.width:"+$(document).width() +" , infoPanel.height : "+  $(document).height());
      
      if($(window).width() > $(window).height()){
            $("body").addClass("horizonMode");
            winWidth = $(window).height();
            $(".infoPanel").width($(window).width() - winWidth);
            $(".shareTime").css("bottom", "10px")
        }else{
            $(".shareTime").css("bottom", $(".infoPanel").outerHeight() + 60 + "px")
            winWidth = $(window).width();
        }
        $("#map_div").width(winWidth);
        $(".wrap").width($(window).width())

        init();  

        var orientation = 0;
        if(deviceCheck() == "ios"){
            orientation = window.orientation;
        }else{
            orientation = window.screen.orientation.angle;
        }
        pastOrientaion = orientation;
        
        $(window).resize(function(){
            setTimeout(function(){resizeCall()}, 100);  
        })
    
  });
  
  
  function resizeCall(){
      if(deviceCheck() == "ios"){
            orientation = window.orientation;
        }else{
            orientation = window.screen.orientation.angle;
        }
        
        console.log($(window).width() + "/////" + $(window).height())

        if(pastOrientaion == orientation) {return;}
        else {pastOrientaion = orientation}

        if(Math.abs(orientation) == 90){
            $("body").addClass("horizonMode");
            winWidth = $(window).height();
            $(".infoPanel").width($(window).width() - winWidth);
            $("#map_div").height(winWidth - 51)
            $(".shareTime").css("bottom", "10px");
        }else{
            
            $("body").removeClass("horizonMode");
            winWidth = $(window).width();           
            $(".infoPanel").width(winWidth);
            $("#map_div").height($(window).height() - $("header").height() - ($(".infoPanel").outerHeight() + $(".guideBtn").height()));
            $(".shareTime").css("bottom", $(".infoPanel").outerHeight() + 60 + "px")
        }
        $("#map_div").width(winWidth);
        $(".wrap").width($(window).width())
  }
  
  function deviceCheck(){
        var userAgent = navigator.userAgent.toLocaleLowerCase();
        var andro = userAgent.search("android") > -1;
        var iphone = userAgent.search("iphone") > -1;
        var ipod = userAgent.search("ipod") > -1;
        var ipad = userAgent.search("ipad") > -1;

        if(andro){
            return "andro";
        }else if(iphone || ipod || ipad){
            return "ios";
        }else{
            return "none"
        }
    }   


}